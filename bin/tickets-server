#!/usr/bin/env ruby
require 'rubygems'
require 'ramaze'
require 'ramaze/setup'

module Tickets
  VERSION = "0.1.0.3rc"
end

# load config
conf_path = File.expand_path("~/.tickets.conf")
load conf_path if File.exist?(conf_path)

# update config
module Tickets
  module Config
    DB_PATH = File.expand_path("~/.tickets.db") unless defined?(DB_PATH)
    PORT = 7007 unless defined?(PORT)

    SHAKE_INTERVAL = 24 unless defined?(SHAKE_INTERVAL) # hours
    SHAKE_DISTANCE = 8 unless defined?(SHAKE_DISTANCE) # pixels

    BOARD_WIDTH  = 600 unless defined?(BOARD_WIDTH) # pixels
    BOARD_HEIGHT = 600 unless defined?(BOARD_HEIGHT) # pixels
  end
end

# connect database
$LOAD_PATH.unshift(File.expand_path("../", File.dirname(__FILE__)))
require 'model/ticket'

# controllers
require 'controller/init.rb'

Dir.chdir(File.expand_path("..", File.dirname(__FILE__)))
Ramaze.start :port => Tickets::Config::PORT,
             :root => Dir.pwd
